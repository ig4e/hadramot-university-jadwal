(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[755],{8995:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/tables/create",function(){return a(6295)}])},9247:function(e,l,a){"use strict";var t=a(5250),r=a(8112),s=a.n(r);a(79);var n=a(6502),d=a(6062),i=a(2949);l.Z=function(e){let{header:l,description:a,link:r,leftSection:c}=e;return(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[l&&(0,t.jsx)(d.Z,{children:l}),a&&(0,t.jsx)(i.Z,{size:"lg",children:a})]}),c?c.children:r&&(0,t.jsxs)(s(),{href:r.href,children:[r.buttonChildren&&(0,t.jsx)(n.Z,{size:"lg",className:"flex items-center gap-2 min-w-max self-end",children:r.buttonChildren}),r.children]})]})}},8383:function(e,l,a){"use strict";a.d(l,{an:function(){return f},ZP:function(){return p},HB:function(){return g}});var t=a(5250),r=a(79),s=a(4031),n=a(6667),d=a(4015),i=a(4574),c=a(2278),o=a(5921);let u=o.y.object().shape({name:o.y.string().required("يرجى ادخال أسم"),subjects:o.y.array().of(o.y.string().required("يرجى أدخال مادة واحدة على الاقل"))});var m=a(4538),x=a(6062),v=a(2949),h=a(6502),j=a(8844),b=a(1977);let f=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],g={SUNDAY:"الأحد",MONDAY:"الأثنين",TUESDAY:"الثلثاء",WEDNESDAY:"الأربعاء",THURSDAY:"الخميس",FRIDAY:"الجمعة",SATURDAY:"السبت"};var p=function(e){var l,a;let{onSubmit:o,defaultData:p}=e,y=m.S.subject.list.useQuery({limit:250}),{register:N,handleSubmit:w,watch:S,control:D,formState:{errors:A},setValue:Z}=(0,c.cI)({resolver:(0,i.X)(u),defaultValues:{name:"",subjects:[""],workDates:[{id:(0,j.Z)(),day:"SUNDAY",value:[8,16]}]}});(0,r.useEffect)(()=>{if(p){let{name:e,subjects:l,workDates:a}=p;Z("name",e),Z("subjects",l),Z("workDates",[]),Z("workDates",a)}},[p]);let{append:Y,remove:I,fields:E}=(0,c.Dq)({name:"workDates",control:D,keyName:"id"}),C=(0,r.useMemo)(()=>{var e;return null===(e=y.data)||void 0===e?void 0:e.items.map(e=>{let{id:l,name:a}=e;return{value:l,label:a}})},[null===(l=y.data)||void 0===l?void 0:l.items]);return(0,t.jsxs)("form",{className:"space-y-8",onSubmit:w(o),children:[(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsxs)("div",{className:"grid grid-flow-row [grid-template-columns:repeat(auto-fill,minmax(250px,1fr));] gap-4 w-full",children:[(0,t.jsxs)("div",{className:"col-span-1 -mt-2",children:[(0,t.jsx)(x.Z,{size:"sm",children:"معلومات المعلم"}),(0,t.jsx)(s.o,{...N("name"),label:"أسم المعلم",error:null===(a=A.name)||void 0===a?void 0:a.message})]}),(0,t.jsxs)("div",{className:"col-span-1 -mt-2",children:[(0,t.jsx)(x.Z,{size:"sm",children:"مواد المعلم"}),(0,t.jsx)(c.Qr,{name:"subjects",control:D,render:e=>{var l,a;let{field:r}=e;return(0,t.jsx)(n.NU,{...r,label:"مواد المعلم",data:C||[],error:null==A?void 0:null===(l=A.subjects)||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:a.message})}})]})]})}),(0,t.jsxs)("div",{className:"pt-4 border-t space-y-4",children:[(0,t.jsx)(x.Z,{size:"sm",children:"توافر المعلم"}),(0,t.jsxs)(d.m,{defaultValue:"SUNDAY",children:[(0,t.jsx)(d.m.List,{children:f.map(e=>(0,t.jsx)(d.m.Tab,{value:e,children:g[e]},e+"tab"))}),f.map((e,l)=>(0,t.jsxs)(d.m.Panel,{value:e,pt:"md",className:"space-y-10 mx-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(x.Z,{size:"sm",children:["توافر المعلم يوم ",g[e]]}),(0,t.jsxs)(v.Z,{size:"sm",children:["هنا يمكنك تحديد توافر المعلم فى يوم ",g[e]]})]}),(0,t.jsx)(h.Z,{size:"md",onClick:()=>Y({day:e,id:(0,j.Z)(),value:[16,20]}),children:"أضف وقت توفر"})]}),E.map((l,a)=>{let{id:r,day:s,value:n}=l;if(e==s)return(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)(c.Qr,{name:"workDates.".concat(a,".value"),control:D,render:e=>{let{field:{onChange:l,onBlur:a,value:r,name:s,ref:n}}=e;return(0,t.jsx)(b.Z,{className:"w-full",onChange:l,onBlur:a,value:[r[0],r[1]],name:s})}}),(0,t.jsx)(h.Z,{intent:"danger",onClick:()=>I(a),size:"md",children:"حذف"})]},r)})]},e+"tabPanel"))]})]}),(0,t.jsx)("div",{className:"border-t-2 border-slate-300 rounded"}),(0,t.jsx)(h.Z,{type:"submit",children:"حفظ"})]})}},6502:function(e,l,a){"use strict";var t=a(5250),r=a(9841);a(79),l.Z=function(e){let{children:l,size:a="lg",className:s,intent:n="primary",...d}=e;return(0,t.jsx)("button",{type:"button",...d,className:(0,r.Z)("rounded-md font-medium transition enabled:hover:-translate-y-0.5 enabled:active:hover:translate-y-0 disabled:opacity-50 select-none",{"text-xl font-medium py-2 px-4 rounded-lg":"lg"===a,"text-lg py-1 px-2":"md"===a,"text-md py-1 px-2":"sm"===a,"bg-blue-600 enabled:hover:bg-blue-700 enabled:active:bg-blue-800 text-neutral-50 ":"primary"===n,"bg-red-600 enabled:hover:bg-red-700 enabled:active:bg-red-800 text-neutral-50 ":"danger"===n,"bg-slate-600 enabled:hover:bg-slate-700 enabled:active:bg-slate-800 text-neutral-50 ":"secondary"===n,"border-2 border-slate-600 enabled:hover:border-slate-700 enabled:active:border-slate-800 text-slate-600 enabled:hover:text-slate-700 enabled:active:text-slate-800":"outline"===n},s),children:l})}},6062:function(e,l,a){"use strict";var t=a(5250),r=a(9841);a(79),l.Z=function(e){let{children:l,size:a="lg",className:s}=e;return(0,t.jsx)("div",{className:(0,r.Z)("font-semibold",{"text-2xl md:text-3xl lg:text-4xl font-semibold":"lg"===a,"text-lg md:text-xl lg:text-2xl font-semibold":"md"===a,"text-base md:text-lg lg:text-xl font-semibold":"sm"===a},s),children:l})}},2949:function(e,l,a){"use strict";var t=a(5250),r=a(9841);a(79),l.Z=function(e){let{children:l,size:a="lg",className:s}=e;return(0,t.jsx)("div",{className:(0,r.Z)("",{"text-base lg:text-lg":"lg"===a,"text-sm lg:text-base":"md"===a,"text-xs lg:text-sm":"sm"===a},s),children:l})}},1977:function(e,l,a){"use strict";var t=a(5250),r=a(1506),s=a(9402),n=a(79),d=a(7449);l.Z=function(e){let{error:l,...a}=e,[i,c]=(0,n.useState)(a.value||[8,16]);return(0,t.jsxs)("div",{className:(0,r.Z)(a.className,""),children:[(0,t.jsx)(s.U,{...a,className:(0,r.Z)(a.className,"w-full"),max:24,maxRange:24,minRange:.25,label:d.L,step:.25,marks:Array.from({length:48}).map((e,l)=>({value:l/2})),onChange:e=>{a.onChange&&a.onChange(e),c(e)},value:i,color:l&&"red"}),(0,t.jsxs)("div",{className:(0,r.Z)("relative",{"text-red-500":!!l}),children:[(0,t.jsxs)("span",{className:"whitespace-nowrap self-start top-0 left-0 absolute",children:[(0,d.L)(i[0])," ألى ",(0,d.L)(i[1])]}),(0,t.jsx)("div",{className:"h-4 w-1 block"}),l&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)("span",{className:"",dangerouslySetInnerHTML:{__html:l}})},"sliderError")})]})]})}},6295:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return Y}});var t=a(5250),r=a(4574),s=a(183),n=a(3139),d=a(9174),i=a(79),c=a(2278),o=a(8844),u=a(9247),m=a(3752),x=a(1380),v=a(9841),h=a(4538),j=a(8383),b=a(6502),f=a(1903),g=a(2382),p=function(e){let{disabled:l,className:a,data:r,label:s,placeholder:n,onChange:d,value:c,error:o,...u}=e,[m,h]=(0,i.useState)({value:c,label:""}),[j,b]=(0,i.useState)("");(0,i.useEffect)(()=>{m&&d&&d(m.value)},[m]),(0,i.useEffect)(()=>{h(r.find(e=>e.value===c)||{value:c})},[c]);let p=(0,i.useMemo)(()=>""===j?r:r.filter(e=>{var l,a,t,r,s;return null===(l=e.label)||void 0===l?void 0:null===(a=l.toLowerCase)||void 0===a?void 0:null===(t=a.call(l))||void 0===t?void 0:null===(r=t.includes)||void 0===r?void 0:r.call(t,null==j?void 0:null===(s=j.toLowerCase)||void 0===s?void 0:s.call(j))}),[j,r]);return(0,t.jsxs)("div",{children:[s&&(0,t.jsx)("label",{className:"text-sm",children:s}),(0,t.jsx)(f.h,{value:m,onChange:h,disabled:l,children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("div",{className:"relative w-full cursor-default overflow-hidden rounded bg-white",children:[(0,t.jsx)(f.h.Input,{...u,className:(0,v.Z)("w-full py-2 pr-3 pl-10 text-sm leading-5 rounded text-gray-900 focus:outline-none focus:ring-0  border border-gray-300 focus:border-blue-600",{"focus:!border-red-600 !border-red-300":!!o,"bg-slate-100 cursor-not-allowed":l}),displayValue:e=>e.label,onChange:e=>b(e.target.value),placeholder:n}),(0,t.jsx)(f.h.Button,{className:"absolute inset-y-0 left-0 flex items-center pl-2 bg-transparent",children:(0,t.jsx)(x.v4q,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),(0,t.jsx)("span",{className:"!text-xs text-red-500",children:o}),(0,t.jsx)(g.u,{as:i.Fragment,afterLeave:()=>b(""),children:(0,t.jsx)(f.h.Options,{className:"absolute mt-1 max-h-60 w-full overflow-auto rounded bg-white p-1 text-base shadow-md ring-1 ring-black ring-opacity-5 z-50 focus:outline-none sm:text-sm",children:0===p.length&&""!==j?(0,t.jsx)("div",{className:"relative cursor-default select-none py-2 px-4 text-gray-700",children:"لا يوجد نتائج."}):p.map(e=>(0,t.jsx)(f.h.Option,{className:e=>{let{active:l}=e;return"relative rounded cursor-default select-none py-2 pl-10 pr-4 ".concat(l?"bg-blue-600 text-white":"text-gray-900")},value:e,children:l=>{let{selected:a,active:r}=l;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:" truncate w-full ".concat(a?"font-medium":"font-normal"),children:e.label}),a?(0,t.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 ".concat(r?"text-white":"text-blue-600"),children:(0,t.jsx)(x.nQG,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.value))})})]})})]})},y=a(1977);function N(e){var l;let{index:a,day:r,control:n,onDelete:d}=e,o=(0,c.Gc)();o.getValues();let u=(0,c.qo)({control:n,name:"majorId"}),{teacherId:m,hallId:v,timeRange:j,id:f}=(0,c.qo)({control:n,name:"".concat(r,".").concat(a)})||{},g=null===(l=o.formState.errors[r])||void 0===l?void 0:l[a],N=h.S.hall.list.useQuery({limit:250}),w=h.S.teacher.list.useQuery({limit:250}),S=h.S.major.get.useQuery({id:u}),D=h.S.teacher.get.useQuery({id:m}),A=(0,i.useMemo)(()=>{var e;return(null===(e=w.data)||void 0===e?void 0:e.items.map(e=>{let{id:l,name:a}=e;return{value:l,label:a}}))||[]},[w.data]),Z=(0,i.useMemo)(()=>{var e;return(null===(e=D.data)||void 0===e?void 0:e.subjects.map(e=>{let{id:l,name:a}=e;return{value:l,label:a}}))||[]},[D.data]);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"w-1/4",children:(0,t.jsx)(c.Qr,{control:n,name:"".concat(r,".").concat(a,".teacherId"),render:e=>{var l;let{field:a}=e;return(0,t.jsx)(p,{...a,placeholder:"يرجى أختيار معلم",data:A,error:null==g?void 0:null===(l=g.teacherId)||void 0===l?void 0:l.message})}})}),(0,t.jsx)("td",{className:"w-1/6",children:(0,t.jsx)(c.Qr,{control:n,name:"".concat(r,".").concat(a,".subjectId"),render:e=>{var l;let{field:a}=e;return(0,t.jsx)(s.Ph,{...a,data:Z,disabled:!m,error:null==g?void 0:null===(l=g.subjectId)||void 0===l?void 0:l.message})}})}),(0,t.jsx)("td",{className:"w-1/6",children:(0,t.jsx)(c.Qr,{control:n,name:"".concat(r,".").concat(a,".hallId"),render:e=>{var l,a;let{field:r}=e;return(0,t.jsx)(p,{...r,data:(null===(l=N.data)||void 0===l?void 0:l.items.filter(e=>{var l;let{studentsCount:a}=e;return a>=((null===(l=S.data)||void 0===l?void 0:l.studentsCount)||0)}).map(e=>{let{id:l,name:a,studentsCount:t}=e;return{value:l,label:a+" (".concat(t,"ط)")}}))||[],disabled:!S.data,error:null==g?void 0:null===(a=g.hallId)||void 0===a?void 0:a.message})}})}),(0,t.jsx)("td",{className:"w-1/2",children:(0,t.jsx)(c.Qr,{control:n,name:"".concat(r,".").concat(a,".timeRange"),render:e=>{var l;let{field:a}=e;return(0,t.jsx)(y.Z,{...a,error:null==g?void 0:null===(l=g.timeRange)||void 0===l?void 0:l.message,disabled:!m})}})}),(0,t.jsx)("td",{className:"w-1",children:(0,t.jsxs)(b.Z,{size:"md",intent:"danger",className:"flex items-center gap-2",onClick:d,children:[(0,t.jsx)(x.XHJ,{}),(0,t.jsx)("span",{children:"حذف"})]})})]})}var w=function(e){let{control:l,day:a}=e,{fields:r,append:s,remove:n}=(0,c.Dq)({control:l,name:a});return(0,t.jsxs)("div",{className:"grid md:[grid-template-columns:_15%_85%;] lg:[grid-template-columns:_10%_90%;] xl:[grid-template-columns:_5%_95%;] ",children:[(0,t.jsx)("div",{className:(0,v.Z)("py-2 w-full flex justify-center items-center bg-slate-900 text-slate-50"),children:(0,t.jsx)("span",{children:j.HB[a]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(m.i,{className:"bg-slate-900 rounded-l-md ",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"!text-slate-50",children:"المعلم"}),(0,t.jsx)("th",{className:"!text-slate-50",children:"المادة"}),(0,t.jsx)("th",{className:"!text-slate-50",children:"القاعة"}),(0,t.jsx)("th",{className:"!text-slate-50",children:"الوقت"})]})}),(0,t.jsx)("tbody",{className:"bg-slate-50 border rounded-md",children:r.map((e,r)=>{let{id:s,teacherId:d,subjectId:i,timeRange:c}=e;return(0,t.jsx)(N,{control:l,day:a,onDelete:()=>{n(r)},index:r},s)})})]}),0===r.length&&(0,t.jsx)("div",{className:"w-full text-center my-4",children:(0,t.jsx)("span",{className:"text-lg ",children:"يوم فارغ"})}),(0,t.jsx)("div",{className:"mr-2.5 my-2",children:(0,t.jsxs)(b.Z,{size:"md",className:"w-full flex gap-2 items-center justify-center",onClick:()=>s({id:(0,o.Z)(),teacherId:"",subjectId:"",hallId:"",timeRange:[8,16]}),children:[(0,t.jsx)(x.pOD,{className:"h-5 w-5 stroke-1 stroke-white"}),"أضف محاضرة"]})})]})]})},S=a(9597),D=a(5921);let A=D.y.array().of(D.y.object().shape({id:D.y.string().required(),teacherId:D.y.string().required("يرجى أختيار معلم"),subjectId:D.y.string().required("يرجى أختيار المادة"),hallId:D.y.string().required("يرجى أختيار القاعة"),timeRange:D.y.array().of(D.y.number().required()).length(2)})),Z=D.y.object().shape({semester:D.y.number().required("يرجى أختيار الفصل الدارسى"),acceptType:D.y.number().required("يرجى أختيار نوع القبول"),majorId:D.y.string().required("يرجى أختيار التخصص"),level:D.y.number().required("يرجى أختيار المستوى"),SUNDAY:A,MONDAY:A,TUESDAY:A,WEDNESDAY:A,THURSDAY:A,FRIDAY:A,SATURDAY:A});var Y=function(){let e=(0,S.r)(),l=(0,c.cI)({defaultValues:{semester:1,acceptType:1,majorId:"",level:1,SUNDAY:[{id:(0,o.Z)(),teacherId:"",subjectId:"",hallId:"",timeRange:[8,16]}],MONDAY:[],TUESDAY:[],WEDNESDAY:[],THURSDAY:[],FRIDAY:[],SATURDAY:[]},resolver:(0,r.X)(Z)}),{clearErrors:a,control:m,formState:{errors:x},getFieldState:v,getValues:f,handleSubmit:g,register:p,reset:y,resetField:N,setError:D,setFocus:A,setValue:Y,trigger:I,unregister:E,watch:C}=l,T=(0,c.qo)({control:m,name:"acceptType"});(0,i.useEffect)(()=>{Y("majorId","")},[T]);let k=h.S.table.create.useMutation(),R=h.S.major.list.useQuery({limit:250,type:T}),U=(0,i.useMemo)(()=>{var e;return null===(e=R.data)||void 0===e?void 0:e.items.map(e=>{let{id:l,name:a}=e;return{value:l,label:a}})},[R.data]),_=(0,c.qo)({control:m}),q=h.S.table.validate.useQuery({..._},{cacheTime:0}),Q=(0,d.useRouter)();async function L(l){try{let a=await k.mutateAsync({...l});if(a.error)return Object.keys(a.errors).map(e=>D(e,{message:a.errors[e]})),e.notify({success:!1,title:"هناك مشكلة بالمدخلات",description:"".concat(Object.values(a.errors).join("<br/>"))});e.notify({success:!0,title:"تم انشاء الجدول بنجاح"}),Q.push("/")}catch(l){e.notify({success:!0,title:"تعذر انشاء الجدول!",description:"تعذر انشاء الجدول يرجى المحاولة مرة اخرى"})}}return(0,i.useEffect)(()=>{q.data&&(console.log(q.data),Object.keys(q.data.errors).map(e=>D(e,{message:q.data.errors[e]})))},[q.data]),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(u.Z,{header:"أنشاء جدول جديد",description:"هنا يمكنك أنشاء جدول"}),(0,t.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,t.jsx)(c.Qr,{control:m,name:"semester",render:e=>{var l;let{field:a}=e;return(0,t.jsx)(s.Ph,{label:"أختر الفصل الدراسى",placeholder:"الفصل الدراسى",data:[{value:"1",label:"الأول"},{value:"2",label:"الثانى"}],onChange:e=>a.onChange(Number(e)),value:String(a.value),onBlur:a.onBlur,ref:a.ref,name:a.name,error:null===(l=x.semester)||void 0===l?void 0:l.message})}}),(0,t.jsx)(c.Qr,{control:m,name:"acceptType",render:e=>{var l;let{field:a}=e;return(0,t.jsx)(s.Ph,{label:"أختر نوع القبول",placeholder:"نوع القبول",data:[{value:"1",label:"عام"},{value:"2",label:"موازى"}],onChange:e=>a.onChange(Number(e)),value:String(a.value),onBlur:a.onBlur,ref:a.ref,name:a.name,error:null===(l=x.acceptType)||void 0===l?void 0:l.message})}}),(0,t.jsx)(c.Qr,{control:m,name:"majorId",render:e=>{var l;let{field:a}=e;return(0,t.jsx)(s.Ph,{label:"أختر التخصص",placeholder:"التخصص",data:U||[],rightSection:R.isLoading&&(0,t.jsx)(n.a,{className:"w-5"}),disabled:R.isLoading,...a,error:null===(l=x.majorId)||void 0===l?void 0:l.message})}}),(0,t.jsx)(c.Qr,{control:m,name:"level",render:e=>{var l;let{field:a}=e;return(0,t.jsx)(s.Ph,{label:"أختر المستوى",placeholder:"المستوى",data:[{value:"1",label:"الأول"},{value:"2",label:"الثانى"},{value:"3",label:"الثالث"},{value:"4",label:"الرابع"}],disabled:R.isLoading,error:null===(l=x.level)||void 0===l?void 0:l.message,onChange:e=>a.onChange(Number(e)),value:String(a.value),onBlur:a.onBlur,ref:a.ref,name:a.name})}})]}),(0,t.jsx)(c.RV,{...l,children:(0,t.jsxs)("form",{onSubmit:g(L),className:"space-y-8",children:[(0,t.jsx)("div",{children:j.an.map(e=>(0,t.jsx)(w,{control:m,day:e},e))}),(0,t.jsx)(b.Z,{type:"submit",children:"حفظ"})]})})]})}},7449:function(e,l,a){"use strict";a.d(l,{L:function(){return s}});var t=a(7354),r=a.n(t);function s(e){return r()().startOf("day").set("second",3600*e).format("hh:mm A").replace(/[0-9]/g,e=>Number(e).toLocaleString("ar-AE"))}a(9823),r().locale("ar-sa")},5921:function(e,l,a){"use strict";a.d(l,{y:function(){return t}});var t=a(4004),r=a(8155);t.setLocale(r.ar)}},function(e){e.O(0,[609,850,271,794,785,696,774,888,179],function(){return e(e.s=8995)}),_N_E=e.O()}]);